import{u as j,j as e}from"./index-DJqCrzXW.js";import{r as i,b as v,u as w,L as y}from"./router-BSEL9h4o.js";import"./supabase-BtyFyo3r.js";import"./vendor-RGnvvjkK.js";const B=()=>{i.useEffect(()=>{window.scrollTo(0,0)},[]);const[n,u]=i.useState(""),[r,a]=i.useState(!1),o=v(),h=w(),{signIn:g,checkInnExists:b,verificationStatus:t,loginError:l,clearLoginError:d,setLoginError:c}=j(),m=h.state?.from?.pathname||"/documents",f=async s=>{s.preventDefault(),n.trim()&&await x()},x=async()=>{a(!0),d();try{(await g(n.trim())).success&&o(m,{replace:!0})}catch(s){console.error("Login error:",s)}finally{a(!1)}},p=async()=>{a(!0),d();try{const s=await b(n.trim());s.exists&&s.data?(console.log("Local login successful:",s.data),o(m,{replace:!0})):c({message:"Данные не найдены в локальном реестре",showRetryButtons:!1})}catch(s){console.error("Local login error:",s),c({message:"Ошибка при входе через локальный реестр",showRetryButtons:!0})}finally{a(!1)}};return e.jsx("div",{className:"w-full max-w-md mx-auto px-4 py-8 flex justify-center",children:e.jsxs("div",{className:"w-full bg-white p-8 rounded-xl shadow-md",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"mx-auto bg-blue-100 p-3 rounded-full w-16 h-16 flex items-center justify-center mb-4",children:e.jsxs("svg",{className:"icon-xl text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",strokeWidth:"1.5",children:[e.jsx("circle",{cx:"12",cy:"12",r:"11"}),e.jsx("circle",{cx:"12",cy:"9",r:"3"}),e.jsx("path",{d:"M5 20c0-3 3-5 7-5s7 2 7 5"})]})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Вход для членов СРО"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Введите ваш ИНН для доступа к личному кабинету"})]}),e.jsxs("form",{onSubmit:f,children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{htmlFor:"inn",className:"flex items-center text-gray-700 text-sm font-bold mb-2",children:[e.jsx("svg",{className:"icon-standard mr-1 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),"ИНН"]}),e.jsx("input",{type:"text",id:"inn",value:n,onChange:s=>u(s.target.value),disabled:r,className:"shadow appearance-none border rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"Введите 10 или 12 цифр",required:!0,pattern:"\\d{10}|\\d{12}",title:"ИНН должен состоять из 10 (для юрлиц) или 12 (для физлиц) цифр"})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("button",{type:"submit",disabled:r,className:"btn-primary w-full flex justify-center items-center disabled:opacity-50 disabled:cursor-not-allowed",children:r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Вход..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"icon-standard mr-2 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})}),"Войти"]})})})]}),t.isChecking&&e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600 mr-3"}),e.jsx("span",{className:"text-blue-800 text-sm font-medium",children:t.currentStep})]}),t.currentStep&&!t.isChecking&&e.jsx("div",{className:`mt-4 p-3 border rounded-lg flex items-center ${t.dataSource?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:t.dataSource?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5 text-green-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),e.jsx("span",{className:"text-green-800 text-sm font-medium",children:"Данные найдены успешно"})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5 text-red-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),e.jsx("span",{className:"text-red-800 text-sm font-medium",children:"Данные не найдены"})]})}),l&&e.jsxs("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center mb-3",children:[e.jsx("svg",{className:"w-5 h-5 text-red-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-red-800 text-sm font-medium",children:l.message})]}),l.showRetryButtons&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:x,disabled:r,className:"flex-1 bg-blue-600 text-white py-2 px-3 rounded-lg hover:bg-blue-700 disabled:opacity-50 text-sm font-medium",children:"Попробовать ещё раз"}),e.jsx("button",{onClick:p,disabled:r,className:"flex-1 bg-green-600 text-white py-2 px-3 rounded-lg hover:bg-green-700 disabled:opacity-50 text-sm font-medium",children:"Войти через локальный реестр"})]}),e.jsx("button",{onClick:()=>o("/"),className:"w-full bg-gray-600 text-white py-2 px-4 rounded-lg hover:bg-gray-700 text-sm font-medium",children:"Перейти на Главную страницу"})]})]}),e.jsxs("div",{className:"mt-6 text-center text-sm text-gray-600",children:[e.jsx("p",{children:"Еще не являетесь членом СРО?"}),e.jsx(y,{to:"/chat",className:"text-blue-600 hover:underline font-medium",children:"Получите бесплатную консультацию"})]})]})})};export{B as default};
